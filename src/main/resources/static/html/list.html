<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<link rel="shortcut icon" href="../image/icon.png">
	<title>看风了风</title>

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="../plugins/index/css/bootstrap.min.css" />

	<!-- Owl Carousel -->
	<link type="text/css" rel="stylesheet" href="../plugins/index/css/owl.carousel.css" />
	<link type="text/css" rel="stylesheet" href="../plugins/index/css/owl.theme.default.css" />

	<!-- Magnific Popup -->
	<link type="text/css" rel="stylesheet" href="../plugins/index/css/magnific-popup.css" />

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" type="text/css" href="../css/font-awesome.css">

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="../plugins/index/css/style.css" />

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

	<link rel="stylesheet" type="text/css" href="../plugins/sweet-alert/sweetalert2.css" />
	<script src="../plugins/sweet-alert/sweetalert2.js"></script>
	<link href="../plugins/page/myPage.css" rel="stylesheet" type="text/css" />

	<link rel="stylesheet" type="text/css" href="../plugins/sweet-alert/sweetalert2.css" />
	<script src="../plugins/sweet-alert/sweetalert2.js"></script>

	<style>
		h2 {
			font-size: 24px;
			line-height: 45px;
			font-weight: normal;
		}
		.pagination > li > a:focus, .pagination > li > a:hover, .pagination > li > span:focus, .pagination > li > span{
			color:#6195FF ;
		}
		.pagination > .active > a, .pagination > .active > a:focus, .pagination > .active > a:hover, .pagination > .active > span, .pagination > .active > span:focus, .pagination > .active > span:hover{
			background-color: #6195FF;
			border-color: #6195FF;
		}
	</style>
</head>

<body>

<!-- Header -->
<header>

	<!-- Nav -->
	<nav id="nav" class="navbar">
		<div class="container">

			<div class="navbar-header">
				<!-- Logo -->
				<div class="navbar-brand">
					<a href="/">
						<!--<img class="logo" src="img/logo.png" alt="logo">-->
						<h2 style="color:#6195FF">看风了风</h2>
					</a>
				</div>
				<!-- /Logo -->

				<!-- Collapse nav button -->
				<div class="nav-collapse">
					<span></span>
				</div>
				<!-- /Collapse nav button -->
			</div>

			<!--  Main navigation  -->
			<ul class="main-nav nav navbar-nav navbar-right">
				<li><a href="/">首页</a></li>
				<li><a href="javascript:toMore(1)">电影</a></li>
				<li><a href="javascript:toMore(2)">电视剧</a></li>
				<li><a href="javascript:toMore(3)">综艺</a></li>
				<li><a href="javascript:toMore(4)">动漫</a></li>
				<li><a href="javascript:request()">留言求片</a></li>
				<li><a href="/login" target="_blank">注册登录</a></li>
			</ul>
			<!-- /Main navigation -->

		</div>
	</nav>
	<!-- /Nav -->

	<!-- header wrapper -->
	<div class="header-wrapper sm-padding bg-grey">
		<div class="container">
			<ul class="breadcrumb">
				<li class="breadcrumb-item"><a href="/">首页</a></li>
				<li id="tab2" class="breadcrumb-item active">列表</li>
			</ul>
		</div>
	</div>
	<!-- /header wrapper -->

</header>
<!-- /Header -->

<!-- Blog -->
<div id="blog" class="section md-padding">

	<!-- Container -->
	<div class="container">

		<!-- Row -->
		<div class="row">

			<!-- Main -->
			<div class="col-md-9">

				<div id="itemWrap"></div>

				<!-- item -->
				<!--<div class="col-md-4">
					<div class="blog">
						<div class="blog-img">
							<img class="img-responsive" src="../plugins/index/img/blog1.jpg" alt="">
						</div>
						<div class="blog-content">
							<ul class="blog-meta">
								<li><i class="fa fa-user"></i>John doe</li>
								<li><i class="fa fa-clock-o"></i>18 Oct</li>
								<li><i class="fa fa-eye"></i>2018</li>
								<li><i class="fa fa-comments"></i>57</li>
							</ul>
							<h5>电影标题</h5>
							<p>Nec feugiat nisl pretium fusce id velit ut tortor pretium. Nisl purus in mollis nunc sed. Nunc non blandit massa enim nec.</p>
							<a href="blog-single.html">查看详情</a>
						</div>
					</div>
				</div>-->
				<!-- /item -->

			</div>
			<!-- /Main -->

			<!-- Aside -->
			<aside id="aside" class="col-md-3">

				<!-- Search -->
				<div class="widget">
					<div class="widget-search">
						<input class="search-input" type="text" onclick="searchResource()" placeholder="搜索资源">
						<button class="search-btn" type="button"><i class="fa fa-search"></i></button>
					</div>
				</div>
				<!-- /Search -->

				<!-- Category -->
				<div class="widget">
					<h3 class="title">目录概览</h3>
					<div id="categoryWrap" class="widget-category">
						<!--<a href="#">Web Design<span>(7)</span></a>-->
					</div>
				</div>
				<!-- /Category -->

				<!-- Posts sidebar -->
				<div class="widget">
					<h3 class="title">最多观看</h3>

					<div id="popularWrap"></div>
					<!-- item -->
					<!--<div class="widget-post">
						<a href="#">
							<img src="../plugins/index/img/post1.jpg" alt=""> Blog title goes here
						</a>
						<ul class="blog-meta">
							<li>Oct 18, 2017</li>
						</ul>
					</div>-->
					<!-- /item -->

				</div>
				<!-- /Posts sidebar -->

				<!-- Tags -->
				<!--<div class="widget">
					<h3 class="title">Tags</h3>
					<div class="widget-tags">
						<a href="#">Web</a>
						<a href="#">Design</a>
						<a href="#">Graphic</a>
						<a href="#">Marketing</a>
						<a href="#">Development</a>
						<a href="#">Branding</a>
						<a href="#">Photography</a>
					</div>
				</div>-->
				<!-- /Tags -->

			</aside>
			<!-- /Aside -->

		</div>
		<!-- /Row -->

		<div class="row" style="text-align: center;margin-top: 6%">
			<div class="col-md-9">
				<form id="form1" runat="server">
					<div>
					</div>
					<div>
						<ul class="pagination" id="pagination">
						</ul>
						<input type="hidden" id="PageCount" runat="server" />
						<input type="hidden" id="PageSize" runat="server" value="16" />
						<input type="hidden" id="countindex" runat="server" value="10"/>
						<!--设置最多显示的页码数 可以手动设置 默认为6-->
						<input type="hidden" id="visiblePages" runat="server" value="6" />
					</div>
				</form>
			</div>
		</div>

	</div>
	<!-- /Container -->

</div>
<!-- /Blog -->



<!-- Footer -->
<footer id="footer" class="sm-padding bg-dark">

	<!-- Container -->
	<div class="container">

		<!-- Row -->
		<div class="row">

			<div class="col-md-12">

				<!-- footer logo -->
				<div class="footer-logo">
					<a href="#" style="color: #ffffff;font-size: 28px">看风了风</a>
				</div>
				<!-- /footer logo -->

				<!-- footer copyright -->
				<div class="footer-copyright" style="text-transform:none">
					<p>本站资源均由机器人自动爬取于互联网</p>
					<p>如若侵犯到您的权益请邮件联系imsprojo2fan@gmail.com,我们将尽快处理</p>
					<p>Copyright © 2018. All Rights Reserved.</p>
				</div>
				<!-- /footer copyright -->

			</div>

		</div>
		<!-- /Row -->

	</div>
	<!-- /Container -->

</footer>
<!-- /Footer -->

<!-- search -->
<div id="search" onclick="searchResource()" title="搜索资源">
	<i class="fa  fa-search"></i>
</div>
<!-- /search -->

<!-- Back to top -->
<div id="back-to-top"></div>
<!-- /Back to top -->

<!-- Preloader -->
<div id="preloader">
	<div class="preloader">
		<span></span>
		<span></span>
		<span></span>
		<span></span>
	</div>
</div>
<!-- /Preloader -->

<!-- jQuery Plugins -->
<script src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../plugins/index/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../plugins/index/js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../plugins/index/js/jquery.magnific-popup.js"></script>
<script type="text/javascript" src="../plugins/index/js/main.js"></script>
<script src="../plugins/page/jqPaginator.min.js" type="text/javascript"></script>
<script src="../plugins/page/myPage.js" type="text/javascript"></script>
<script src="../js/gutil.js" type="text/javascript"></script>

<script>

	var GlobalType;
	var SearchKey = "";
	$(function () {

        //分页获取资源列表
        listItem(1,16);

    });

    function listItem(pageNow,pageSize) {

        $.post("/index/resource/list",{pageNow:pageNow,pageSize:pageSize,key:SearchKey},function (r) {
            console.log(r);

            var tab = "";
            var types = r.type;
            var type = parseInt(types);

            if(type===1){
                tab = "电影列表";
            }else if(type===2){
                tab = "电视剧列表";
            }else if(type===3){
                tab = "综艺列表";
            }else if(type===4){
                tab = "动漫列表";
            }
            $('#tab2').html(tab);

            $('#itemWrap').html("");
            var dataArr = r.data;
            if(dataArr.length==0){
                $('#itemWrap').html("<p>暂无数据</p>");
			}
            for(var i=0;i<dataArr.length;i++){
                var obj = dataArr[i];
                var imgSrc = "https://interesting.zooori.cn/pic/"+obj.imgSrc1;
                //var description = obj.description.substring(0,15)+"...";
                var error = "../image/error1.png";
                $('#itemWrap').append('<div class="col-sm-3">\n' +
                    '\t\t\t\t\t<div onclick="toDetail('+obj.type+','+obj.id+')" class="blog">\n' +
                    '\t\t\t\t\t\t<div class="blog-img">\n' +
                    '\t\t\t\t\t\t\t<img onerror=src="'+error+'" class="img-responsive" src="'+imgSrc+'" alt="图片加载失败">\n' +
                    '\t\t\t\t\t\t</div>\n' +
                    '\t\t\t\t\t\t<div class="blog-content">\n' +
                    '\t\t\t\t\t\t\t<h5>'+obj.name+'</h5>\n' +
                    '\t\t\t\t\t\t\t<a href="javascript:void(0)">查看详情</a>\n' +
                    '\t\t\t\t\t\t</div>\n' +
                    '\t\t\t\t\t</div>\n' +
                    '\t\t\t\t</div>')
            }
            if(pageNow===1&&r.recordsTotal!=0){
                loadData(r.recordsTotal);
                loadpage();
			}

            //获取目录概览数据
            $.post("/index/resource/category",{},function (r) {
                console.log(r);
                $('#categoryWrap').html("");
                var title;
                if(r.length==0){
                    $('#categoryWrap').html("<p>暂无数据</p>");
				}
                for(var i=0;i<r.length;i++){
                    var obj = r[i];
                    if(i===0){
                        title = "电影";
					}else if(i===1){
                        title = "电视剧";
					}else if(i===2){
                        title = "综艺";
					}else{
                        title = "动漫";
					}
					var type = i+1;
                    $('#categoryWrap').append('<a onclick="toMore('+type+')" href="javascript:void(0)">'+title+'<span>('+obj+')</span></a>');
				}
            });

            //获取最多观看数据
            $.post("/index/resource/list4order",{col:"views"},function (r) {
                console.log(r);
                $('#popularWrap').html("");
                if(r.length==0){
                    $('#popularWrap').html("<p>暂无数据</p>");
                    return;
				}
                for(var j=0;j<r.length;j++){
                    var obj = r[j];
                    var imgSrc = "https://interesting.zooori.cn/pic/"+obj.imgSrc1;
                    var error = "../image/error1.png";
                    $('#popularWrap').append('<div class="widget-post">\n' +
                        '\t\t\t\t\t\t<a onclick="toDetail('+obj.type+','+obj.id+')" href="javascript:void(0);">\n' +
                        '\t\t\t\t\t\t\t<img style="width: 20%" onerror=src="'+error+'" src="'+imgSrc+'" alt="图片加载失败"> '+obj.name+'\n' +
                        '\t\t\t\t\t\t</a>\n' +
                        '\t\t\t\t\t\t<ul class="blog-meta">\n' +
                        '\t\t\t\t\t\t\t<li><i class="fa fa-eye">'+obj.views+'</i></li>\n' +
                        '\t\t\t\t\t\t</ul>\n' +
                        '\t\t\t\t\t</div>');
                }
            });

        });
    }

    function toMore(type) {
        $.post("/setSession",{type:type},function (r) {
            if(r.code==1){
                window.location.href = "/list";
            }
        });
    }

    function toDetail(type,itemId) {
        $.post("/setSession",{type:type,itemId:itemId},function (r) {
            if(r.code==1){
                window.location.href = "/single";
            }
        });
    }

    function searchResource() {
        swal({
            title: '请输入资源名称',  //标题
            input: 'text',
            showCancelButton: true,
            cancelButtonText:'取消',
            confirmButtonText: '确定',
            showLoaderOnConfirm: true,
            preConfirm: function(val) {               //功能执行前确认操作，支持function
                return new Promise(function(resolve, reject) {
                    SearchKey = val;
                    listItem(1,16);
                    resolve();

                    /*setTimeout(function() {                 //添加一个时间函数，在俩秒后执行，这里可以用作异步操作数据
                        if (email === 'taken@example.com') {  //这里的意思是：如果输入的值等于'taken@example.com',数据已存在，提示信息
                            reject('用户已存在')                  //提示信息
                        } else {
                            resolve()                           //方法出口
                        }
                    }, 2000)*/
                })
            },
            allowOutsideClick: false
        }).then(function(val) {
            console.log(val)
        });
    }

    function request() {
        addCookie("request","request",1,"/");
        window.location.href = "/";
    }

</script>

</body>

</html>
